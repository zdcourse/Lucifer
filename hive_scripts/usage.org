hive -f <hive script file>

* select01
    select * from sogou_ext_20111230 limit 10;

* select 02
    select url from sogou_ext_20111230 limit 10;

* select03
    select count(*) from sogou.sogou_ext_20111230;

* select04 非空查询条数
    insert overwrite local directory '/output/select04' row format delimited fields terminated by '\t'
    select count(*) from sogou.sogou_ext_20111230 where keyword is not null and keyword !='';

* select05 无重复总条数
    select count(*) from (select ts, uid, keyword, url
    from sogou.sogou_ext_20111230
    group by ts, uid, keyword, url having count(*)=1) a;

* select06 独立 UID 总数
    select count(distinct(uid) from sogou.sogou_ext_20111230;

* select07 查询关键词长度统计
    select avg(a.cnt)
    from (select size(split(keyword, '\\s+')) as cnt
    from sogou.sogou_ext_20111230) a;

* select08 查询频度排名（前 50）
    select keyword, count(*) as cnt
    from sogou.sogou_ext_20111230
    group by keyword order by cnt desc limit 50;


* select09 UID 查询次数分布
    select sum(if(uids.cnt=1, 1, 0)),sum(if(uids.cnt=2,1,0)), sum(if(uids.cnt=3,1,0)), sum(if(uids.cnt>3,1,0))
    from
    (select uid, count(*) as cnt from sogou.sogou_ext_20111230 group by uid) uids;
