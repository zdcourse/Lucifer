* Lucifer
Sogou 数据分析(个人)


** 作业要求
利用 hadoop 平台，将 sogou 数据进行分析，数据大小为 2.14G，记录数为 4500 万条，

基于 map-reduce 代码实现一种数据挖掘或机器学习方法，例如聚类、分类、异常检测等，完成数据分析报告，并提交相关代码

使用 hive 对数据进行统计分析，完成数据分析报告，并提交相关代码

参考手册见附件，仅用于借鉴参考，分析更多的结果，并以图表化结果展示

分析报告，不少于 30 页，有完整的脚本或代码

2017.11.22 日晚上 12 点前班长统一收齐上交

** 操作步骤

*** 查看数据




** 四、条数统计
    数据总条数
    #+BEGIN_SRC sql
    select count(*) from sogou.sogou_ext_20111230
    #+END_SRC

    非空查询条数
    #+BEGIN_SRC sql
    select count(*) from sogou.sogou_ext_20111230 where keyword is not null and keyword !='';
    #+END_SRC

    无重复总条数
    #+BEGIN_SRC sql
    select count(*) from (select ts, uid, keyword, url
    from sogou.sogou_ext_20111230
    group by ts, uid, keyword, url having count(*)=1) a;
    #+END_SRC

    独立 UID 总数
    #+BEGIN_SRC sql
    select count(distinct(uid) from sogou.sogou_ext_20111230;
    #+END_SRC

** 五、关键词分析
    查询关键词长度统计
    #+BEGIN_SRC sql
    select avg(a.cnt)
    from (select size(split(keyword, '\\s+')) as cnt
    from sogou.sogou_ext_20111230) a;
    #+END_SRC

    查询频度排名（前 50）
    #+BEGIN_SRC sql
    select keyword, count(*) as cnt
    from sogou.sogou_ext_20111230
    group by keyword order by cnt desc limit 50;
    #+END_SRC

** 六、UID 分析
    UID 查询次数分布
    #+BEGIN_SRC sql
    select
    #+END_SRC
